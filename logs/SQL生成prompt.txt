
你是一个 ClickHouse SQL 生成专家。当前的本地时间是 2025年12月23日 16:30
请根据提供的数据库表结构和用户问题以及从相关文档中提取的案例信息，生成 SQL 查询语句。


## 任务说明
请按照以下步骤思考，最后生成SQL：

### 第1步：理解用户问题
【用户问题】
大修报告主表里阳江1号机各“报告状态”的大修报告数量占比怎么分布？（输出饼图）
请分析：
- 分析用户的核心需求是什么
- 识别问题中的关键实体和条件
- 明确需要查询的数据维度
- 判断是否有排序、分组、聚合等需求

### 第2步：分析数据库结构
【数据库表结构】
[
  {
    "序号": 2,
    "英文表名": "ads_sap_reform_data_related_ai",
    "中文表名": "已关联对象SAP改造通知单",
    "一级业务模块": "电子履历",
    "二级业务模块": "履历查询",
    "建表语句": "CREATE TABLE ads_sap_reform_data_related_ai\n(\n\n    `notice_code` String COMMENT 通知单\n)\nENGINE = ReplacingMergeTree\nPRIMARY KEY notice_code\nORDER BY notice_code\nSETTINGS index_granularity = 8192\nCOMMENT SAP改造已关联对象通知单\n",
    "关联表名": "ads_sap_reform_data_ai",
    "表关键字": "",
    "字段映射": {
      "notice_code": "通知单"
    },
    "字段类型": {
      "notice_code": "String"
    },
    "样例数据": [
      "Row 1: notice_code: 200000000017",
      "Row 2: notice_code: 200000000019",
      "Row 3: notice_code: 200000001702",
      "Row 4: notice_code: 200000001769",
      "Row 5: notice_code: 200000001976"
    ]
  },
  {
    "序号": 45,
    "英文表名": "oh_report_anal_aft_health_ai",
    "中文表名": "大修后健康状态分析",
    "一级业务模块": "大修分析",
    "二级业务模块": "大修分析",
    "建表语句": "CREATE TABLE oh_report_anal_aft_health_ai\n(\n\n    `id` String COMMENT 主键,\n\n    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,\n\n    `object_code` Nullable(String) COMMENT 对象编码,\n\n    `health_model_num` Int32 DEFAULT 0 COMMENT 总计健康分析模型,\n\n    `degraded_number` Int32 DEFAULT 0 COMMENT 累计健康降级数量,\n\n    `trend_overview` Nullable(String) COMMENT 趋势综述,\n\n    `suggestions` Nullable(String) COMMENT 大修关注建议,\n\n    `update_user` Nullable(String) COMMENT 修改人用户ID,\n\n    `update_user_name` Nullable(String) COMMENT 修改人姓名,\n\n    `update_time` DateTime DEFAULT now() COMMENT 修改时间,\n\n    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,\n\n    `create_time` DateTime DEFAULT now() COMMENT 创建时间,\n\n    `source_type` Int32 DEFAULT 0 COMMENT 来源类型：0=手动，1=自动\n)\nENGINE = ReplacingMergeTree\nPRIMARY KEY id\nORDER BY (id,\n report_code)\nSETTINGS index_granularity = 8192\nCOMMENT 大修后健康状态分析\n",
    "关联表名": "oh_report_info_ai, oh_report_anal_health_ai, oh_report_anal_aft_monitor_ai, oh_report_anal_re_view_ai",
    "表关键字": "",
    "字段映射": {
      "id": "主键",
      "report_code": "报告编号（关联外键：oh_report_info.report_code）",
      "object_code": "对象编码",
      "health_model_num": "总计健康分析模型",
      "degraded_number": "累计健康降级数量",
      "trend_overview": "趋势综述",
      "suggestions": "大修关注建议",
      "update_user": "修改人用户ID",
      "update_user_name": "修改人姓名",
      "update_time": "修改时间",
      "deleted_flag": "逻辑删除字段",
      "create_time": "创建时间",
      "source_type": "来源类型：0=手动，1=自动"
    },
    "字段类型": {
      "id": "String",
      "report_code": "String",
      "object_code": "Nullable(String)",
      "health_model_num": "Int32",
      "degraded_number": "Int32",
      "trend_overview": "Nullable(String)",
      "suggestions": "Nullable(String)",
      "update_user": "Nullable(String)",
      "update_user_name": "Nullable(String)",
      "update_time": "DateTime",
      "deleted_flag": "Int8",
      "create_time": "DateTime",
      "source_type": "Int32"
    },
    "样例数据": [
      "Row 1: id: 01ecbf3eb770f4f4ae58e47f637e6690 | report_code: ND1N104000006 | object_code: ND1CRF001MO&RRCB01 | health_model_num: 1 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:14:20 | deleted_flag: 0 | create_time: 2025-11-11 11:14:20 | source_type: 1",
      "Row 2: id: 029c0ad48af397206eee1cd92ef1295d | report_code: ND1N104000007 | object_code: ND1CRF001MO&MOHB01 | health_model_num: 4 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:14:32 | deleted_flag: 0 | create_time: 2025-11-11 11:14:33 | source_type: 1",
      "Row 3: id: 0329297f6d16d1305d6f66bcce60929d | report_code: ND1N104000020 | object_code: ND1CRF001MO&MOHB01 | health_model_num: 4 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:16:38 | deleted_flag: 0 | create_time: 2025-11-11 11:16:39 | source_type: 1",
      "Row 4: id: 0588c2e5015c9f7835c9b4792ea6a1f7 | report_code: ND1N104000014 | object_code: ND1CRF001MO&MOHB01 | health_model_num: 4 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:15:54 | deleted_flag: 0 | create_time: 2025-11-11 11:15:54 | source_type: 1",
      "Row 5: id: 09721f8e8682f7e9f36d5c3a03ac8270 | report_code: ND1N104000002 | object_code: ND1CRF001MO&RRCB01 | health_model_num: 1 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:12:19 | deleted_flag: 0 | create_time: 2025-11-11 11:12:19 | source_type: 1"
    ]
  },
  {
    "序号": 46,
    "英文表名": "oh_report_anal_aft_monitor_ai",
    "中文表名": "大修后状态监测分析",
    "一级业务模块": "大修分析",
    "二级业务模块": "大修分析",
    "建表语句": "CREATE TABLE oh_report_anal_aft_monitor_ai(    `id` String COMMENT 主键,    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,    `object_code` Nullable(String) COMMENT 对象编码,    `effective_monitor_points` Int32 DEFAULT 0 COMMENT 总计有效监测点,    `alarms_number` Int32 DEFAULT 0 COMMENT 累计报警数量,    `change_number` Int32 DEFAULT 0 COMMENT 变化数量,    `trend_overview` Nullable(String) COMMENT 趋势综述,    `suggestions` Nullable(String) COMMENT 大修关注建议,    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `create_time` DateTime DEFAULT now() COMMENT 创建时间,    `ext_data_json` Nullable(String) COMMENT 扩展JSON数据,    `source_type` Int32 DEFAULT 0 COMMENT 来源类型：0=手动，1=自动)ENGINE = ReplacingMergeTreePRIMARY KEY idORDER BY (id, report_code)SETTINGS index_granularity = 8192COMMENT 大修后状态监测分析",
    "关联表名": "oh_report_info_ai, oh_report_anal_aft_monitor_detail_ai, oh_report_anal_aft_health_ai, oh_report_anal_re_view_ai, oh_report_anal_monitor_ai",
    "表关键字": "",
    "字段映射": {
      "id": "主键,    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,    `object_code` Nullable(String) COMMENT 对象编码,    `effective_monitor_points` Int32 DEFAULT 0 COMMENT 总计有效监测点,    `alarms_number` Int32 DEFAULT 0 COMMENT 累计报警数量,    `change_number` Int32 DEFAULT 0 COMMENT 变化数量,    `trend_overview` Nullable(String) COMMENT 趋势综述,    `suggestions` Nullable(String) COMMENT 大修关注建议,    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `create_time` DateTime DEFAULT now() COMMENT 创建时间,    `ext_data_json` Nullable(String) COMMENT 扩展JSON数据,    `source_type` Int32 DEFAULT 0 COMMENT 来源类型：0=手动，1=自动)ENGINE = ReplacingMergeTreePRIMARY KEY idORDER BY (id, report_code"
    },
    "字段类型": {
      "id": "String",
      "report_code": "String",
      "object_code": "Nullable(String)",
      "effective_monitor_points": "Int32",
      "alarms_number": "Int32",
      "change_number": "Int32",
      "trend_overview": "Nullable(String)",
      "suggestions": "Nullable(String)",
      "update_user": "Nullable(String)",
      "update_user_name": "Nullable(String)",
      "update_time": "DateTime",
      "deleted_flag": "Int8",
      "create_time": "DateTime",
      "ext_data_json": "Nullable(String)",
      "source_type": "Int32"
    },
    "样例数据": [
      "Row 1: id: 00e3ae54918a443ebb1e6f2a8a12821f | report_code: ND1N104000022 | object_code: ND1CRF001MO&MOHB01 | effective_monitor_points: 0 | alarms_number: 0 | change_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:18:02 | deleted_flag: 0 | create_time: 2025-11-20 16:59:58 | ext_data_json: {\"dataMap1Time\": [\"2017-07-01 04:34:00\", \"2017-07-08 04:34:00\"], \"dataMap2Time\": [\"2025-11-14 10:30:00\", \"2025-11-21 10:30:00\"], \"dataMap3Time\": [\"2025-11-21 10:30:00\", \"2025-12-21 10:30:00\"], \"dataMap4Time\": [\"2025-12-21 10:30:00\", \"2025-12-28 10:30:00\"]} | source_type: 1",
      "Row 2: id: 03cda28560a644d9b529be47089e067d | report_code: LA1L120000001 | object_code: LA1CRF001PO&RRGA11 | effective_monitor_points: 0 | alarms_number: 0 | change_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2024-12-17 10:09:06 | deleted_flag: 0 | create_time: 2024-12-31 06:02:20 | ext_data_json:  | source_type: 1",
      "Row 3: id: 04654689f4af42bbb2bead5243970656 | report_code: YJ1Y108000022 | object_code: YJ1CRF001PO&POCA30 | effective_monitor_points: 0 | alarms_number: 0 | change_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2024-10-15 14:49:44 | deleted_flag: 0 | create_time: 2024-10-16 16:59:08 | ext_data_json:  | source_type: 1",
      "Row 4: id: 05772fd2c7ee4aa39423745b8fda0067 | report_code: ND1N104000020 | object_code: ND1CRF001MO&MOHB01 | effective_monitor_points: 0 | alarms_number: 0 | change_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-11 11:16:38 | deleted_flag: 0 | create_time: 2025-11-20 16:59:16 | ext_data_json: {\"dataMap1Time\": [\"2017-07-01 04:34:00\", \"2017-07-08 04:34:00\"], \"dataMap2Time\": [\"2025-11-14 10:30:00\", \"2025-11-21 10:30:00\"], \"dataMap3Time\": [\"2025-11-21 10:30:00\", \"2025-12-21 10:30:00\"], \"dataMap4Time\": [\"2025-12-21 10:30:00\", \"2025-12-28 10:30:00\"]} | source_type: 1",
      "Row 5: id: 079a74ad32244ec592c7a6d005d07e72 | report_code: YJ1Y108000014 | object_code: YJ1CRF001PO&POCA30 | effective_monitor_points: 0 | alarms_number: 0 | change_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2024-10-15 14:49:13 | deleted_flag: 0 | create_time: 2024-10-16 16:59:01 | ext_data_json:  | source_type: 1"
    ]
  },
  {
    "序号": 52,
    "英文表名": "oh_report_anal_health_ai",
    "中文表名": "大修报告健康分析表",
    "一级业务模块": "大修分析",
    "二级业务模块": "大修分析",
    "建表语句": "CREATE TABLE oh_report_anal_health_ai\n(\n\n    `id` String COMMENT 主键,\n\n    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,\n\n    `object_code` String COMMENT 对象编码,\n\n    `health_analysis_model_num` Int32 DEFAULT 0 COMMENT 总计健康分析模型,\n\n    `degraded_number` Int32 DEFAULT 0 COMMENT 本循环累计健康降级数量,\n\n    `trend_overview` Nullable(String) COMMENT 趋势综述,\n\n    `suggestions` Nullable(String) COMMENT 大修关注建议,\n\n    `update_user` Nullable(String) COMMENT 修改人用户ID,\n\n    `update_user_name` Nullable(String) COMMENT 修改人姓名,\n\n    `update_time` DateTime DEFAULT now() COMMENT 修改时间,\n\n    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,\n\n    `create_time` DateTime DEFAULT now() COMMENT 创建时间,\n\n    `source_type` Int32 DEFAULT 0 COMMENT 来源类型：0=手动，1=自动\n)\nENGINE = ReplacingMergeTree\nPRIMARY KEY id\nORDER BY (id, report_code, object_code)\nSETTINGS index_granularity = 8192\nCOMMENT 大修报告健康分析表\n",
    "关联表名": "oh_report_info_ai, oh_report_anal_monitor_ai, oh_report_anal_aft_health_ai, oh_report_anal_re_view_ai",
    "表关键字": "",
    "字段映射": {
      "id": "主键",
      "report_code": "报告编号（关联外键：oh_report_info.report_code）",
      "object_code": "对象编码",
      "health_analysis_model_num": "总计健康分析模型",
      "degraded_number": "本循环累计健康降级数量",
      "trend_overview": "趋势综述",
      "suggestions": "大修关注建议",
      "update_user": "修改人用户ID",
      "update_user_name": "修改人姓名",
      "update_time": "修改时间",
      "deleted_flag": "逻辑删除字段",
      "create_time": "创建时间",
      "source_type": "来源类型：0=手动，1=自动"
    },
    "字段类型": {
      "id": "String",
      "report_code": "String",
      "object_code": "String",
      "health_analysis_model_num": "Int32",
      "degraded_number": "Int32",
      "trend_overview": "Nullable(String)",
      "suggestions": "Nullable(String)",
      "update_user": "Nullable(String)",
      "update_user_name": "Nullable(String)",
      "update_time": "DateTime",
      "deleted_flag": "Int8",
      "create_time": "DateTime",
      "source_type": "Int32"
    },
    "样例数据": [
      "Row 1: id: 005b8d2421cd15971560d4acb4e3cb5e | report_code: HY1H110000002 | object_code: HY1CGR005PO&POPE20 | health_analysis_model_num: 0 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2024-09-12 09:42:24 | deleted_flag: 0 | create_time: 2024-09-12 09:42:24 | source_type: 1",
      "Row 2: id: 00905a18a147b95a21860763b7aa6a83 | report_code: ND1N105000004 | object_code: ND1CRF001PO&POZB01 | health_analysis_model_num: 0 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user: P640777 | update_user_name: [P640777]郭进 | update_time: 2024-12-23 14:21:19 | deleted_flag: 0 | create_time: 2024-12-23 09:25:03 | source_type: 1",
      "Row 3: id: 00ffb836ce0151ce9a3c7498047d0aea | report_code: YJ1Y109000004 | object_code: YJ1CRF001PO&POCA30 | health_analysis_model_num: 2 | degraded_number: 2 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2024-09-24 06:00:24 | deleted_flag: 0 | create_time: 2024-09-24 06:00:25 | source_type: 1",
      "Row 4: id: 0115a9a6f129ddaa42315424fe0cbd3b | report_code: YJ5Y506000001 | object_code: YJ5CGR001FI&FINC31 | health_analysis_model_num: 0 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-11-07 14:37:19 | deleted_flag: 0 | create_time: 2025-11-07 14:37:19 | source_type: 1",
      "Row 5: id: 019fbe30c1146538b139f39826673269 | report_code: TS1T103000007 | object_code: TS1CRF1120RR-&RRGA40 | health_analysis_model_num: 9 | degraded_number: 0 | trend_overview:  | suggestions:  | update_user: P640431 | update_user_name: [P640431]季久伟 | update_time: 2024-10-14 09:30:08 | deleted_flag: 0 | create_time: 2024-10-14 09:19:47 | source_type: 1"
    ]
  },
  {
    "序号": 54,
    "英文表名": "oh_report_anal_monitor_ai",
    "中文表名": "大修报告状态监测分析表",
    "一级业务模块": "大修分析",
    "二级业务模块": "大修分析",
    "建表语句": "CREATE TABLE oh_report_anal_monitor_ai(    `id` String COMMENT 主键,    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,    `object_code` String COMMENT 对象编码,    `effective_monitor_points` Int32 DEFAULT 0 COMMENT 总计有效监测点,    `alarms_number` Int32 DEFAULT 0 COMMENT 本循环累计报警数量,    `trend_overview` Nullable(String) COMMENT 趋势综述,    `suggestions` Nullable(String) COMMENT 大修关注建议,    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `create_time` DateTime DEFAULT now() COMMENT 创建时间,    `ext_data_json` Nullable(String) COMMENT 扩展JSON数据,    `source_type` Int32 DEFAULT 0 COMMENT 来源类型：0=手动，1=自动)ENGINE = ReplacingMergeTreePRIMARY KEY idORDER BY (id, report_code, object_code)SETTINGS index_granularity = 8192COMMENT 大修报告状态监测分析表",
    "关联表名": "oh_report_info_ai, oh_report_anal_health_ai, oh_report_anal_aft_monitor_ai, oh_report_anal_re_view_ai",
    "表关键字": "",
    "字段映射": {
      "id": "主键,    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,    `object_code` String COMMENT 对象编码,    `effective_monitor_points` Int32 DEFAULT 0 COMMENT 总计有效监测点,    `alarms_number` Int32 DEFAULT 0 COMMENT 本循环累计报警数量,    `trend_overview` Nullable(String) COMMENT 趋势综述,    `suggestions` Nullable(String) COMMENT 大修关注建议,    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `create_time` DateTime DEFAULT now() COMMENT 创建时间,    `ext_data_json` Nullable(String) COMMENT 扩展JSON数据,    `source_type` Int32 DEFAULT 0 COMMENT 来源类型：0=手动，1=自动)ENGINE = ReplacingMergeTreePRIMARY KEY idORDER BY (id, report_code, object_code"
    },
    "字段类型": {
      "id": "String",
      "report_code": "String",
      "object_code": "String",
      "effective_monitor_points": "Int32",
      "alarms_number": "Int32",
      "trend_overview": "Nullable(String)",
      "suggestions": "Nullable(String)",
      "update_user": "Nullable(String)",
      "update_user_name": "Nullable(String)",
      "update_time": "DateTime",
      "deleted_flag": "Int8",
      "create_time": "DateTime",
      "ext_data_json": "Nullable(String)",
      "source_type": "Int32"
    },
    "样例数据": [
      "Row 1: id: 0017fcb8e76f6c16d8eb9bd9d435df02 | report_code: ND1N107000003 | object_code: ND1CRF001MO&MOHB01 | effective_monitor_points: 0 | alarms_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-01-20 14:03:09 | deleted_flag: 0 | create_time: 2025-01-20 14:03:10 | ext_data_json:  | source_type: 1",
      "Row 2: id: 0077f999ad4393867f81431e194002f0 | report_code: ND1N105000030 | object_code: ND1CRF001MO&RRCB01 | effective_monitor_points: 0 | alarms_number: 0 | trend_overview:  | suggestions:  | update_user: P635920 | update_user_name: [P635920]刘庆 | update_time: 2025-10-31 15:46:46 | deleted_flag: 0 | create_time: 2025-06-11 17:25:49 | ext_data_json:  | source_type: 1",
      "Row 3: id: 00d3f8df38ae9707376e9c1dcee7f18b | report_code: ND1N106000001 | object_code: ND1CRF001PO&RRCB02 | effective_monitor_points: 0 | alarms_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2025-01-17 19:43:44 | deleted_flag: 0 | create_time: 2025-01-17 19:43:45 | ext_data_json:  | source_type: 1",
      "Row 4: id: 01087edf7bb8489b63ab5eb0eaf36ede | report_code: HY1H109000005 | object_code: HY1CRF001MO&MOHB20 | effective_monitor_points: 0 | alarms_number: 0 | trend_overview:  | suggestions:  | update_user: P620611 | update_user_name: [P620611]陈昌民 | update_time: 2025-03-28 19:30:23 | deleted_flag: 0 | create_time: 2025-02-28 06:00:37 | ext_data_json: {\"alarmsMptCode\": \"HY4CRF002PO.GCH.BRb_Si\"} | source_type: 1",
      "Row 5: id: 014e55803ee38107dbe1b07f73296e22 | report_code: ND1N107000001 | object_code: ND1CRF001MO&RRCB01 | effective_monitor_points: 0 | alarms_number: 0 | trend_overview:  | suggestions:  | update_user:  | update_user_name:  | update_time: 2024-12-20 09:36:31 | deleted_flag: 0 | create_time: 2024-12-20 09:36:31 | ext_data_json:  | source_type: 1"
    ]
  },
  {
    "序号": 55,
    "英文表名": "oh_report_anal_obj_ai",
    "中文表名": "大修报告选择试用分析对象表",
    "一级业务模块": "大修分析",
    "二级业务模块": "大修分析",
    "建表语句": "CREATE TABLE oh_report_anal_obj_ai(    `id` String COMMENT 主键,    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,    `object_code` String COMMENT 对象编码,    `object_desc` Nullable(String) COMMENT 对象描述,    `related_terms` Nullable(String) COMMENT 分级条款,    `class_lev` Nullable(String) COMMENT 分级等级：R，E，S，C,    `responsible_person` Nullable(String) COMMENT 分析负责人,    `responsible_person_name` Nullable(String) COMMENT 分析负责人姓名,    `responsible_person_update_time` Nullable(DateTime) COMMENT 分析责任人更新时间,    `total_running_time` Int32 DEFAULT 0 COMMENT 本循环累计运行时间(单位h),    `total_running_times` Int32 DEFAULT 0 COMMENT 本循环累计启停次数(次),    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `create_time` DateTime DEFAULT now() COMMENT 创建时间,    `func_pos` Nullable(String) COMMENT SAP功能位置)ENGINE = ReplacingMergeTreePRIMARY KEY idORDER BY (id, report_code, object_code)SETTINGS index_granularity = 8192COMMENT 大修报告选择试用分析对象表",
    "关联表名": "oh_report_info_ai",
    "表关键字": "",
    "字段映射": {
      "id": "主键,    `report_code` String COMMENT 报告编号（关联外键：oh_report_info.report_code）,    `object_code` String COMMENT 对象编码,    `object_desc` Nullable(String) COMMENT 对象描述,    `related_terms` Nullable(String) COMMENT 分级条款,    `class_lev` Nullable(String) COMMENT 分级等级：R，E，S，C,    `responsible_person` Nullable(String) COMMENT 分析负责人,    `responsible_person_name` Nullable(String) COMMENT 分析负责人姓名,    `responsible_person_update_time` Nullable(DateTime) COMMENT 分析责任人更新时间,    `total_running_time` Int32 DEFAULT 0 COMMENT 本循环累计运行时间(单位h),    `total_running_times` Int32 DEFAULT 0 COMMENT 本循环累计启停次数(次),    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `create_time` DateTime DEFAULT now() COMMENT 创建时间,    `func_pos` Nullable(String) COMMENT SAP功能位置)ENGINE = ReplacingMergeTreePRIMARY KEY idORDER BY (id, report_code, object_code"
    },
    "字段类型": {
      "id": "String",
      "report_code": "String",
      "object_code": "String",
      "object_desc": "Nullable(String)",
      "related_terms": "Nullable(String)",
      "class_lev": "Nullable(String)",
      "responsible_person": "Nullable(String)",
      "responsible_person_name": "Nullable(String)",
      "responsible_person_update_time": "Nullable(DateTime)",
      "total_running_time": "Int32",
      "total_running_times": "Int32",
      "update_user": "Nullable(String)",
      "update_user_name": "Nullable(String)",
      "update_time": "DateTime",
      "deleted_flag": "Int8",
      "create_time": "DateTime",
      "func_pos": "Nullable(String)"
    },
    "样例数据": [
      "Row 1: id: 004680e328c7fe94352abc60368781f6 | report_code: ND1N104000004 | object_code: ND1CRF001PO&RRCB02 | object_desc: PO-RR联轴器（CRF) | related_terms: C9 | class_lev: C | responsible_person: P633395,P634981,P637000,P637969,P644220 | responsible_person_name: 曹国栋,邬家豪,庞宇锋,黄勤勇,陈新 | responsible_person_update_time: None | total_running_time: 11068 | total_running_times: 6 | update_user:  | update_user_name:  | update_time: 2025-11-07 14:32:13 | deleted_flag: 0 | create_time: 2025-11-07 14:32:13 | func_pos: ND-1-31-CRF-001PO",
      "Row 2: id: 008124c86be09927102c4b927395ea4a | report_code: ND1N104000032 | object_code: ND1CRF001RR&RRGA01 | object_desc: 齿轮箱 | related_terms:  | class_lev:  | responsible_person: P633395,P634981,P637000,P637969,P644220 | responsible_person_name: 曹国栋,邬家豪,庞宇锋,黄勤勇,陈新 | responsible_person_update_time: None | total_running_time: 12310 | total_running_times: 26 | update_user:  | update_user_name:  | update_time: 2025-11-07 14:36:16 | deleted_flag: 0 | create_time: 2025-11-07 14:36:16 | func_pos: ND-1-31-CRF-001RR",
      "Row 3: id: 00a1ef81d5c36590842e8481b6ff41f8 | report_code: ND1N106000001 | object_code: ND1CRF001MO&RRCB01 | object_desc: MO-RR联轴器（CRF) | related_terms: C9 | class_lev: C | responsible_person: P634981,P633395,P644220 | responsible_person_name: 曹国栋,邬家豪,陈新 | responsible_person_update_time: None | total_running_time: 6435 | total_running_times: 5 | update_user:  | update_user_name:  | update_time: 2025-01-17 19:43:44 | deleted_flag: 0 | create_time: 2025-01-17 19:43:44 | func_pos: ND-1-31-CRF-001MO",
      "Row 4: id: 012a3b3642ede6e47fcb2e825d65f647 | report_code: DY1D126000005 | object_code: DY1CRF002PO&MOHA10 | object_desc: 6.6KV电机 | related_terms: C9 | class_lev: C | responsible_person:  | responsible_person_name:  | responsible_person_update_time: None | total_running_time: 0 | total_running_times: 0 | update_user: P640777 | update_user_name: [P640777]郭进 | update_time: 2024-11-07 09:01:04 | deleted_flag: 0 | create_time: 2024-11-05 19:02:34 | func_pos: DY-1-31-CRF-002PO",
      "Row 5: id: 0159a87a8de8dae55597b656d8e127a7 | report_code: YJ2Y213000007 | object_code: YJ2CGR001FI&PINC30 | object_desc: 油过滤器 | related_terms:  | class_lev:  | responsible_person:  | responsible_person_name:  | responsible_person_update_time: None | total_running_time: 0 | total_running_times: 0 | update_user:  | update_user_name:  | update_time: 2024-09-24 06:02:29 | deleted_flag: 0 | create_time: 2024-09-24 06:02:29 | func_pos: YJ-2-31-CGR-001FI"
    ]
  },
  {
    "序号": 62,
    "英文表名": "oh_report_info_ai",
    "中文表名": "大修报告主表",
    "一级业务模块": "大修分析",
    "二级业务模块": "大修分析",
    "建表语句": "CREATE TABLE oh_report_info_ai(    `report_code` String COMMENT 报告编号,    `report_name` Nullable(String) COMMENT 报告名称,    `template_code` String COMMENT 模板编码（关联外键：oh_tmpl_info.template_code）,    `proc_id` Nullable(String) COMMENT 流程提交的FormNo前缀,    `base_code` Nullable(String) COMMENT 基地编码,    `set_code` Nullable(String) COMMENT 机组,    `overhaul_rounds` Nullable(String) COMMENT 大修轮次,    `progress` Nullable(String) COMMENT 进展：大修前分析，大修中分析，大修后跟踪,    `status` Int32 DEFAULT 0 COMMENT 状态：0=分析中，1=校核中，2=已完成 ，3=再分析中，4=再校核中，5=已生效,    `responsible_person` Nullable(String) COMMENT 分析对象负责人,    `responsible_person_name` Nullable(String) COMMENT 分析对象负责人姓名,    `concerns_number` Int32 DEFAULT 0 COMMENT 输出关注数量,    `keyword` Nullable(String) COMMENT 综合查询字段,    `last_round_end_time` Nullable(DateTime) COMMENT 上轮大修结束,    `oh_start_date` Nullable(DateTime) COMMENT 大修开始日期,    `oh_plan_start_date` Nullable(String) COMMENT 大修计划开始日期,    `oh_end_date` Nullable(DateTime) COMMENT 大修结束日期,    `pre_last_flush_time` Nullable(DateTime) COMMENT 大修前的最后刷新时间,    `in_last_flush_time` Nullable(DateTime) COMMENT 大修中的最后刷新时间,    `aft_last_flush_time` Nullable(DateTime) COMMENT 大修后的最后刷新时间,    `tracking_date` Nullable(Int32) COMMENT 大修后跟踪(单位周),    `tmpl_version` Nullable(String) DEFAULT 1.0 COMMENT 模板版本（关联外键：oh_tmpl_info.version）,    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `need_flush` Int8 DEFAULT 1 COMMENT 是否需要刷新：0=表示当前大修报告不再需要维护更新,    `create_time` DateTime DEFAULT now() COMMENT 创建时间)ENGINE = ReplacingMergeTreePRIMARY KEY report_codeORDER BY report_codeSETTINGS index_granularity = 8192COMMENT 大修报告主表",
    "关联表名": "omp_nuclesus_item_ai, oh_report_anal_monitor_ai, oh_report_anal_health_ai, oh_report_anal_oh_ex_ai",
    "表关键字": "",
    "字段映射": {
      "report_code": "报告编号,    `report_name` Nullable(String) COMMENT 报告名称,    `template_code` String COMMENT 模板编码（关联外键：oh_tmpl_info.template_code）,    `proc_id` Nullable(String) COMMENT 流程提交的FormNo前缀,    `base_code` Nullable(String) COMMENT 基地编码,    `set_code` Nullable(String) COMMENT 机组,    `overhaul_rounds` Nullable(String) COMMENT 大修轮次,    `progress` Nullable(String) COMMENT 进展：大修前分析，大修中分析，大修后跟踪,    `status` Int32 DEFAULT 0 COMMENT 状态：0=分析中，1=校核中，2=已完成 ，3=再分析中，4=再校核中，5=已生效,    `responsible_person` Nullable(String) COMMENT 分析对象负责人,    `responsible_person_name` Nullable(String) COMMENT 分析对象负责人姓名,    `concerns_number` Int32 DEFAULT 0 COMMENT 输出关注数量,    `keyword` Nullable(String) COMMENT 综合查询字段,    `last_round_end_time` Nullable(DateTime) COMMENT 上轮大修结束,    `oh_start_date` Nullable(DateTime) COMMENT 大修开始日期,    `oh_plan_start_date` Nullable(String) COMMENT 大修计划开始日期,    `oh_end_date` Nullable(DateTime) COMMENT 大修结束日期,    `pre_last_flush_time` Nullable(DateTime) COMMENT 大修前的最后刷新时间,    `in_last_flush_time` Nullable(DateTime) COMMENT 大修中的最后刷新时间,    `aft_last_flush_time` Nullable(DateTime) COMMENT 大修后的最后刷新时间,    `tracking_date` Nullable(Int32) COMMENT 大修后跟踪(单位周),    `tmpl_version` Nullable(String) DEFAULT 1.0 COMMENT 模板版本（关联外键：oh_tmpl_info.version）,    `update_user` Nullable(String) COMMENT 修改人用户ID,    `update_user_name` Nullable(String) COMMENT 修改人姓名,    `update_time` DateTime DEFAULT now() COMMENT 修改时间,    `deleted_flag` Int8 DEFAULT 0 COMMENT 逻辑删除字段,    `need_flush` Int8 DEFAULT 1 COMMENT 是否需要刷新：0=表示当前大修报告不再需要维护更新,    `create_time` DateTime DEFAULT now() COMMENT 创建时间"
    },
    "字段类型": {
      "report_code": "String",
      "report_name": "Nullable(String)",
      "template_code": "String",
      "proc_id": "Nullable(String)",
      "base_code": "Nullable(String)",
      "set_code": "Nullable(String)",
      "overhaul_rounds": "Nullable(String)",
      "progress": "Nullable(String)",
      "status": "Int32",
      "responsible_person": "Nullable(String)",
      "responsible_person_name": "Nullable(String)",
      "concerns_number": "Int32",
      "keyword": "Nullable(String)",
      "last_round_end_time": "Nullable(DateTime)",
      "oh_start_date": "Nullable(DateTime)",
      "oh_plan_start_date": "Nullable(String)",
      "oh_end_date": "Nullable(DateTime)",
      "pre_last_flush_time": "Nullable(DateTime)",
      "in_last_flush_time": "Nullable(DateTime)",
      "aft_last_flush_time": "Nullable(DateTime)",
      "tracking_date": "Nullable(Int32)",
      "tmpl_version": "Nullable(String)",
      "update_user": "Nullable(String)",
      "update_user_name": "Nullable(String)",
      "update_time": "DateTime",
      "deleted_flag": "Int8",
      "need_flush": "Int8",
      "create_time": "DateTime"
    },
    "样例数据": [
      "Row 1: report_code: DY1D124000001 | report_name: 验证大亚湾电厂 | template_code: DY00000001 | proc_id:  | base_code: DY | set_code: DY1 | overhaul_rounds: D124 | progress: 大修中分析 | status: 0 | responsible_person: P634981,P633395 | responsible_person_name: 曹国栋,邬家豪 | concerns_number: 0 | keyword: DY1CRF001PO&POZB10DY1CRF001PO&RRGA10|DY1D124000001验证大亚湾电厂DY00000001DY大亚湾分析中P634981,P633395曹国栋,邬家豪 | last_round_end_time: None | oh_start_date: None | oh_plan_start_date: 2024-10-8 10:37 | oh_end_date: None | pre_last_flush_time: 2024-10-28 14:50:14 | in_last_flush_time: None | aft_last_flush_time: None | tracking_date: 3 | tmpl_version: 1.0 | update_user:  | update_user_name:  | update_time: 2024-09-22 19:34:51 | deleted_flag: 0 | need_flush: 1 | create_time: 2024-09-22 19:34:51",
      "Row 2: report_code: DY1D124000002 | report_name:   | template_code: DY00000005 | proc_id:  | base_code: DY | set_code: DY1 | overhaul_rounds: D124 | progress: 大修中分析 | status: 0 | responsible_person: P636091 | responsible_person_name: 李俞方 | concerns_number: 0 | keyword: DY1CRF001RR&RRGA10DY1CRF002RR&RRGA10|DY1D124000002 DY00000005DY大亚湾分析中P636091李俞方 | last_round_end_time: None | oh_start_date: None | oh_plan_start_date: 2024-10-8 10:37 | oh_end_date: None | pre_last_flush_time: 2024-11-05 19:02:56 | in_last_flush_time: None | aft_last_flush_time: None | tracking_date: 2 | tmpl_version: 0 | update_user:  | update_user_name:  | update_time: 2024-09-23 19:18:31 | deleted_flag: 0 | need_flush: 1 | create_time: 2024-09-23 19:18:31",
      "Row 3: report_code: DY1D124000003 | report_name:   | template_code: DY00000008 | proc_id:  | base_code: DY | set_code: DY1 | overhaul_rounds: D124 | progress: 大修中分析 | status: 0 | responsible_person: P636091 | responsible_person_name: 李俞方 | concerns_number: 0 | keyword: DY1CRF001RR&RRGA10DY1CRF002RR&RRGA10|DY1D124000003 DY00000008DY大亚湾分析中P636091李俞方 | last_round_end_time: None | oh_start_date: None | oh_plan_start_date: 2024-10-8 10:37 | oh_end_date: None | pre_last_flush_time: 2024-11-05 19:02:58 | in_last_flush_time: None | aft_last_flush_time: None | tracking_date: 1 | tmpl_version: 0 | update_user:  | update_user_name:  | update_time: 2024-09-23 19:18:32 | deleted_flag: 0 | need_flush: 1 | create_time: 2024-09-23 19:18:32",
      "Row 4: report_code: DY1D124000004 | report_name: ee | template_code: DY00000013 | proc_id: 27d8e2ac1b7d47edb815b8c16e2fea9f | base_code: DY | set_code: DY1 | overhaul_rounds: D124 | progress: 大修中分析 | status: 3 | responsible_person: P633738,P268434 | responsible_person_name: 刘钢霖,杨瑞玲 | concerns_number: 2 | keyword: DY1CRF002PO&POZB10DY1RCV001PO&VAAJ13DY1RCV001RR&POZF13DY1RCV001RR&RRGA13|DY1D124000004eeDY00000013DY大亚湾分析中 | last_round_end_time: None | oh_start_date: None | oh_plan_start_date: 2024-10-8 10:37 | oh_end_date: None | pre_last_flush_time: None | in_last_flush_time: None | aft_last_flush_time: None | tracking_date: 1 | tmpl_version: 1.0 | update_user: P640777 | update_user_name: [P640777]郭进 | update_time: 2024-10-28 10:56:48 | deleted_flag: 0 | need_flush: 1 | create_time: 2024-10-16 16:59:55",
      "Row 5: report_code: DY1D126000001 | report_name:  | template_code: DY00000001 | proc_id: 4fc6b2e9f4944dcfa237937780584baa | base_code: DY | set_code: DY1 | overhaul_rounds: D126 | progress: 大修中分析 | status: 1 | responsible_person: P634981,P633395 | responsible_person_name: 曹国栋,邬家豪 | concerns_number: 0 | keyword: DY1CRF001PO&POZB10DY1CRF001PO&RRGA10|DY1D126000001DY00000001DY大亚湾分析中P634981,P633395曹国栋,邬家豪 | last_round_end_time: None | oh_start_date: None | oh_plan_start_date: 2024-07-18 03:30 | oh_end_date: None | pre_last_flush_time: 2024-11-07 09:41:38 | in_last_flush_time: None | aft_last_flush_time: None | tracking_date: 1 | tmpl_version: 1.0 | update_user: P634193 | update_user_name: [P634193]邓升娟 | update_time: 2025-06-10 13:54:52 | deleted_flag: 0 | need_flush: 1 | create_time: 2024-06-20 11:41:05"
    ]
  },
  {
    "序号": 86,
    "英文表名": "ads_der_data",
    "中文表名": "群厂DER管理平台业务单数据",
    "一级业务模块": "电子履历",
    "二级业务模块": "履历查询",
    "建表语句": "CREATE TABLE ads_der_data\n(\n\n    `pri_code` Nullable(String) DEFAULT NULL COMMENT 电厂,\n\n    `base_name` Nullable(String) DEFAULT NULL COMMENT 基地名称,\n\n    `der_code` String COMMENT der编码,\n\n    `func_pos` Nullable(String) DEFAULT NULL COMMENT 功能位置,\n\n    `der_title` Nullable(String) DEFAULT NULL COMMENT der主题,\n\n    `content` Nullable(String) DEFAULT NULL COMMENT 措施内容,\n\n    `sys_lev` Nullable(String) DEFAULT NULL COMMENT 系统等级,\n\n    `der_class` Nullable(String) DEFAULT NULL COMMENT der分级,\n\n    `diff_type` Nullable(String) DEFAULT NULL COMMENT 偏差类型,\n\n    `senior_staffname` Nullable(String) DEFAULT NULL COMMENT 申请工程师,\n\n    `apply_datetime` Nullable(DateTime) DEFAULT NULL COMMENT 申请时间,\n\n    `overhaul_rounds` Nullable(String) DEFAULT NULL COMMENT 大修轮次,\n\n    `sys_engineername` Nullable(String) DEFAULT NULL COMMENT 系统工程师,\n\n    `systemnext_datetime` Nullable(DateTime) DEFAULT NULL COMMENT 批准时间,\n\n    `etl_datetime` DateTime COMMENT 抽取时间,\n\n    `der_status` Nullable(String) DEFAULT NULL COMMENT 状态,\n\n    `col_all` Nullable(String) DEFAULT NULL COMMENT 全量原始数据字段,\n\n    `file_js` Nullable(String) DEFAULT NULL COMMENT 附件,\n\n    `new_func_pos` Nullable(String) DEFAULT NULL COMMENT 新功能位置\n)\nENGINE = ReplacingMergeTree(etl_datetime)\nPRIMARY KEY der_code\nORDER BY der_code\nSETTINGS index_granularity = 8192\nCOMMENT 群厂DER管理平台业务单数据\n",
    "关联表名": "ads_sap_der_dy_data",
    "表关键字": "",
    "字段映射": {
      "pri_code": "电厂",
      "base_name": "基地名称",
      "der_code": "der编码",
      "func_pos": "功能位置",
      "der_title": "der主题",
      "content": "措施内容",
      "sys_lev": "系统等级",
      "der_class": "der分级",
      "diff_type": "偏差类型",
      "senior_staffname": "申请工程师",
      "apply_datetime": "申请时间",
      "overhaul_rounds": "大修轮次",
      "sys_engineername": "系统工程师",
      "systemnext_datetime": "批准时间",
      "etl_datetime": "抽取时间",
      "der_status": "状态",
      "col_all": "全量原始数据字段",
      "file_js": "附件",
      "new_func_pos": "新功能位置"
    },
    "字段类型": {
      "pri_code": "Nullable(String)",
      "base_name": "Nullable(String)",
      "der_code": "String",
      "func_pos": "Nullable(String)",
      "der_title": "Nullable(String)",
      "content": "Nullable(String)",
      "sys_lev": "Nullable(String)",
      "der_class": "Nullable(String)",
      "diff_type": "Nullable(String)",
      "senior_staffname": "Nullable(String)",
      "apply_datetime": "Nullable(DateTime)",
      "overhaul_rounds": "Nullable(String)",
      "sys_engineername": "Nullable(String)",
      "systemnext_datetime": "Nullable(DateTime)",
      "etl_datetime": "DateTime",
      "der_status": "Nullable(String)",
      "col_all": "Nullable(String)",
      "file_js": "Nullable(String)",
      "new_func_pos": "Nullable(String)"
    },
    "样例数据": [
      "Row 1: pri_code: NDS | base_name: 宁德 | der_code: EMC-202006-000 | func_pos: N1GPV-301-KO | der_title: N105大修汽轮机轴承部分数据超标  | content: 机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。 | sys_lev: QR | der_class: B | diff_type: 维修处理后，测量参数值超出了维修、运行参数标准值 | senior_staffname: 何洪义 | apply_datetime: 2020-06-23 17:27:48 | overhaul_rounds: N105 | sys_engineername: 钟国兴 | systemnext_datetime: 2020-07-27 10:17:49 | etl_datetime: 2024-09-12 15:32:24 | der_status: 永久关闭 | col_all: 宁德,NDS,EMC-202006-000,N1GPV-301-KO,N105大修汽轮机轴承部分数据超标 ,机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。,QR,B,维修处理后，测量参数值超出了维修、运行参数标准值,何洪义,N105,钟国兴,永久关闭 | file_js: None | new_func_pos: None",
      "Row 2: pri_code: NDS | base_name: 宁德 | der_code: EMC-202006-000test | func_pos: ND-2-31-CRF-001FI | der_title: N105大修汽轮机轴承部分数据超标  | content: 机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。 | sys_lev: QR | der_class: B | diff_type: 维修处理后，测量参数值超出了维修、运行参数标准值 | senior_staffname: 何洪义 | apply_datetime: 2025-05-20 08:05:29 | overhaul_rounds: N105 | sys_engineername: 钟国兴 | systemnext_datetime: 2020-07-27 10:17:49 | etl_datetime: 2024-09-12 15:32:24 | der_status: 永久关闭 | col_all: 宁德,NDS,EMC-202006-000test,ND-2-31-CRF-001FI,N105大修汽轮机轴承部分数据超标 ,机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。,QR,B,维修处理后，测量参数值超出了维修、运行参数标准值,何洪义,N105,钟国兴,永久关闭 | file_js: None | new_func_pos: None",
      "Row 3: pri_code: NDS | base_name: 宁德 | der_code: EMC-202006-000test1 | func_pos: ND-1-31-CRF-001RR | der_title: N105大修汽轮机轴承部分数据超标  | content: 机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。 | sys_lev: QR | der_class: B | diff_type: 维修处理后，测量参数值超出了维修、运行参数标准值 | senior_staffname: 何洪义 | apply_datetime: 2025-11-03 08:07:29 | overhaul_rounds: N105 | sys_engineername: 钟国兴 | systemnext_datetime: 2020-07-27 10:17:49 | etl_datetime: 2024-09-12 15:32:24 | der_status: 永久关闭 | col_all: 宁德,NDS,EMC-202006-000test1,ND-2-31-CRF-001FI,N105大修汽轮机轴承部分数据超标 ,机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。,QR,B,维修处理后，测量参数值超出了维修、运行参数标准值,何洪义,N105,钟国兴,永久关闭 | file_js: None | new_func_pos: None",
      "Row 4: pri_code: NDS | base_name: 宁德 | der_code: EMC-202006-000test2 | func_pos: ND-2-31-CRF-001FI | der_title: N105大修汽轮机轴承部分数据超标  | content: 机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。 | sys_lev: QR | der_class: B | diff_type: 维修处理后，测量参数值超出了维修、运行参数标准值 | senior_staffname: 何洪义 | apply_datetime: 2025-05-20 08:09:29 | overhaul_rounds: N105 | sys_engineername: 钟国兴 | systemnext_datetime: 2024-12-27 12:07:48 | etl_datetime: 2024-09-12 15:32:24 | der_status: 永久关闭 | col_all: 宁德,NDS,EMC-202006-000test2,ND-2-31-CRF-001FI,N105大修汽轮机轴承部分数据超标 ,机组上行前测量顶轴油压，如偏差大于50bar，则现场进行平行度调整。\n启机跟踪至机组满功率，运行两周后，若无异常关闭\n按照现有状态原样回装 。,QR,B,维修处理后，测量参数值超出了维修、运行参数标准值,何洪义,N105,钟国兴,永久关闭 | file_js: None | new_func_pos: None",
      "Row 5: pri_code: NDS | base_name: 宁德 | der_code: EMC-202006-001 | func_pos: N1GPV-102-KO | der_title: N105大修2号轴承箱前后外油挡改造更换  | content: 完成新型油档SR替代论证（SrTempNo:3596、SrTempNo:3583）\n机组启机至满功率开始进行巡检，每周巡检一次，持续1个月\n对新型油挡备件进行检查，包括新加内油档与油封齿同心度检查、油封齿紧固检查、焊接部位PT检查，确保备件无异常\nN105大修更换2号轴承箱新型外油挡  | sys_lev: QR | der_class: B | diff_type: 正式改造、物项替代等的现场临时验证方案 | senior_staffname: 何洪义 | apply_datetime: 2020-06-05 15:06:39 | overhaul_rounds: N105 | sys_engineername: 钟国兴 | systemnext_datetime: 2020-07-27 10:38:07 | etl_datetime: 2024-09-12 15:32:24 | der_status: 永久关闭 | col_all: 宁德,NDS,EMC-202006-001,N1GPV-102-KO,N105大修2号轴承箱前后外油挡改造更换 ,完成新型油档SR替代论证（SrTempNo:3596、SrTempNo:3583）\n机组启机至满功率开始进行巡检，每周巡检一次，持续1个月\n对新型油挡备件进行检查，包括新加内油档与油封齿同心度检查、油封齿紧固检查、焊接部位PT检查，确保备件无异常\nN105大修更换2号轴承箱新型外油挡 ,QR,B,正式改造、物项替代等的现场临时验证方案,何洪义,N105,钟国兴,永久关闭 | file_js: None | new_func_pos: None"
    ]
  }
]

【系统字典结构】
[业务术语与数据库编码映射规则]
- 基地编码（base_code）对应关系：大亚湾 -> 'DY'，宁德 -> 'ND'，阳江 -> 'YJ'，红沿河 -> 'HY'，台山 -> 'TS'，防城港 -> 'FC'
- 机组编码 (set_code)格式为: 基地编码 + 机组号,例如：大亚湾1号机('DY1')，岭澳1号机('LA1')
- 状态(status)：0-分析中 1-校核中 2-已完成 3-再分析中 4-再校核中 5-已生效
- 大修`进展`(progress)：大修前分析，大修中分析，大修后跟踪
- 大修轮次(overhaul_rounds)格式为：基地编码首字母+次数,示例：宁德1号机大修轮次105：'N105(overhaul_rounds: "'N105")

请分析：
1. 哪些表与用户问题相关
2. 表之间的关联关系
3. 字段名称、数据类型和含义
4. 可能需要用到的约束条件

### 第3步：参考相关案例（如提供）
【相关案例】
用户问题: 1. 大亚湾基地状态为“分析中”的大修报告有哪些？
2. 大亚湾基地“分析中”的大修报告有哪些？
查询条件: 查询表：大修报告主表（oh_report_info ）
基地编码：大亚湾（base_code: "DY"）
状态：分析中（status: "0"）
SQL语句: SELECT *
FROM oh_report_info
WHERE base_code = 'DY' 
AND status = '0'
AND deleted_flag = '0'
备注: 状态：
0=分析中或编写中，1=校核中，2=已完成 ，3=再分析中，4=再校核中，5=已生效

---

用户问题: 1. 大亚湾1号机2024年开始大修的大修报告有哪些？
2. 大亚湾1号机大修开始时间在2024年的大修报告有哪些？
查询条件: 查询表：大修报告主表（oh_report_info ）
基地编码：大亚湾（base_code: "DY"）
机组：1号机（set_code: "DY1"）
大修开始日期：2024年  (oh_start_date: ["2024-01-01 00:00:00", "2024-12-31 23:59:59"])
SQL语句: SELECT *  
FROM oh_report_info  
WHERE set_code = 'DY1'  
AND oh_start_date BETWEEN '2024-01-01' AND '2024-12-31'
AND deleted_flag = '0'
备注:

---

用户问题: 1. 大亚湾1号机2024年新增的大修报告有哪些？
2. 大亚湾1号机创建时间在2024年的大修报告有哪些？
查询条件: 查询表：大修报告主表（oh_report_info ）
基地编码：大亚湾（base_code: "DY"）
机组：1号机（set_code: "DY1"）
报告创建日期：2024年  (oh_start_date: ["2024-01-01 00:00:00", "2024-12-31 23:59:59"])
SQL语句: SELECT *  
FROM oh_report_info  
WHERE set_code = 'DY1'  
AND create_time BETWEEN '2024-01-01' AND '2024-12-31'
AND deleted_flag = '0'
备注:

---

用户问题: 1. 大亚湾基地进展为“大修后跟踪”的大修报告有哪些？
2. 大亚湾基地“大修后跟踪”的大修报告有哪些？
查询条件: 查询表：大修报告主表（oh_report_info ）
基地编码：大亚湾（base_code: "DY"）
进展：大修后跟踪
SQL语句: SELECT *
FROM oh_report_info
WHERE base_code = 'DY' 
AND progress = '大修后跟踪'
AND deleted_flag = '0'
备注: 进展：大修前分析，大修中分析，大修后跟踪

---

用户问题: 1. 由“张三”负责分析的大修报告有哪些？
2. 负责人为“张三”的大修报告有哪些？
查询条件: 查询表：大修报告主表（oh_report_info ）
基地编码：红沿河（base_code: "HY"）
机组：1号机（set_code: "HY1"）
SQL语句: SELECT 
    report_code AS 报告编号,
    responsible_person_name AS 负责人姓名
FROM oh_report_info
WHERE  responsible_person_name LIKE '%张三%'
AND deleted_flag = '0'
备注:


请参考：
1. 类似问题的解决方案
2. 常见的查询模式
3. 需要注意的特殊情况

### 第4步：构建SQL逻辑
基于以上分析只使用一个表（从上述表中选择一个最相关的表）构建SQL语句：
```sql
SELECT ... FROM ... WHERE ...;
```
1. 确定查询的SELECT字段
2. 确定FROM表和JOIN关系
3. 确定WHERE条件
4. 确定GROUP BY、HAVING、ORDER BY等子句
5. 考虑是否需要子查询或窗口函数
6. 使用适当的ClickHouse函数和语法(ClickHouse 不支持使用中文作为列别名（AS 后面的名称），除非你用反引号（`）或双引号（"）将它们括起来,例如：SELECT status AS `报告状态`)

### 第5步：丰富SELECT字段
在不会改变查询结果的前提下，尽可能多选择一些维度的数据。特别是，如果表有主键，请尽量包含主键，除非以下情况：
1. 在聚合查询（如使用GROUP BY）中，如果添加主键会导致分组变化，从而改变聚合结果，则不要添加主键。
2. 如果用户明确指定了只需要某些字段，则按用户要求。
3. 保持结果不变：添加字段不能改变原有查询的结果行数、聚合值、排序等。例如，在非聚合查询中，添加主键是安全的；在聚合查询中，可以添加那些在GROUP BY子句中已经包含的字段，或者使用聚合函数包裹的字段。

例如:大亚湾1号机2024年10月份开始大修的大修报告有哪些？原来的SQL:

```sql
SELECT report_code 
FROM oh_report_info 
WHERE base_code = 'DY'
AND set_code = 'DY1'
AND oh_start_date BETWEEN '2024-10-01 00:00:00' AND '2024-10-31 23:59:59';
 ```

丰富后的SQL:
```sql
SELECT *
FROM oh_report_info
WHERE base_code = 'DY'
AND set_code = 'DY1'
AND oh_start_date BETWEEN '2024-10-01 00:00:00' AND '2024-10-31 23:59:59';
```
### 第6步：验证和优化
严格评估sql:
1. 回顾生成的SQL，检查它是否完全符合用户的原始问题和所有逻辑约束。
2. 是否使用了不存在的表名
3. GROUP BY子句是否包含了所有非聚合的SELECT字段？
4. 当问题中包含以下关键词时，必须使用DISTINCT或GROUP BY去重："哪些"、"哪几种"、"哪些类型"、"什么种类""列出所有不同的"、"所有不重复的" "种类"、"类型"、"分类"、“模板数量”
以及其他明确要求唯一值的场景
5. 重点进行字段存在性检查：严格确认SQL中使用的所有字段是否在对应的表结构中存在
6. 确认查询使用的表格是否含有deleted_flag字段，`deleted_flag`代表此条记录是否逻辑删除,如果有deleted_flag字段的表格生成SQL的时候需要加上AND deleted_flag = '0' 作为的过滤条件。(注意deleted_flag = 0 会报错，正确的是deleted_flag = '0')
7. 严格对生成sql所用的表结构信息进行字段检查,没有`deleted_flag`字段的表格生成SQL的时候不要加deleted_flag。

### 第6步：修正SQL
1. 如果在评估中发现任何问题,根据错误原因修改sql
2. 如果在评估中发现任何问题,对sql语句进行修改并重新进行第6步：验证和优化。重新评估sql语句


## 最终输出格式
请输出自我检验与修正后的SQL候选项，严格遵循以下格式请将最终的SQL语句放在```sql ... ```代码块中。，不要有任何额外解释：

```sql
SELECT ... FROM ... WHERE ...;
```

